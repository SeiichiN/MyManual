インターネット概論

/****************************************
コンピューターはどのようにしてお互いを知るのか？
****************************************/

コンピューターはお互いをどのようにして知っているのでしょうか？
コンピューターはIPアドレスという数字でお互いを認識しています。

IPアドレスは、8ビットを4つ組み合わせて作られています。つまり、4バイトです。

11000000 . 10101000 . 00001010 . 00100011

   C   0 .    A   8 .    0   A .    2   3

     192 .      168 .       10 .       35

これは IPv4アドレス と言われていて、インターネットが作られた最初から使われていたものです。しかし、近年ではIPv4アドレスでは足りなくなってきて、IPv6アドレスが使われるようになってきています。

IPアドレスは Windows のコマンドプロンプトで調べることができます。

> ipconfig <Enter>

<Enter>は「Enterキー」を押下することです。

以下のような表示になります。

IPv4アドレス： 192.168.10.35  （35という数字は機械によって違う）
デフォルト・ゲートウェイ： 192.168.10.1
ネットマスク： 255.255.255.0

ここで使われているIPアドレスは、プライベート・IPアドレスと言われるものです。
これについては、次の章で説明します。

デフォルト・ゲートウェイとは、インターネット（外部）に出ていくのに、192.168.10.1というIPアドレスをもつ機械を通るという意味です。

ネットマスクというのは、このプライベート・IPアドレスが、どのレベルのプライベートアドレスなのかを説明しています。

これらは全て、次の章で説明します。

注：IPアドレスが設定されているのは、コンピュータに対してではなく、実際は、ネットワーク・デバイスに対してです。
つまり、ひとつのコンピュータに2つ以上のネットワーク・デバイスを組み込むことができるのです。その場合、そのコンピュータは、2つ以上のネットワークに接続していることになり、そのコンピュータが中継機となります。


/****************************************
インターネットとIPアドレス
****************************************/

全世界のコンピュータは、IPアドレスによってお互いを知っています。ですから、IPアドレスに重複があってはなりません。IPにアドレスは国際的な取り決めによって管理されています。このようなIPアドレスを「グローバルIPアドレス」といいます。

全世界のコンピュータは、IPアドレスによってお互いを知っています。しかし、IPアドレスは数に限りがあるので、近くにあるコンピュータをひとまとまりにして、そのコンピュータのまとまりに対して1つのIPアドレスをわりあてれば非常に能率がよくなります。

ただ、そのひとまとまりのコンピュータにもIPアドレスを割り当てないと、お互いが通信できなくなります。そこで、インターネットに触接つながっているIPアドレスを「グローバルIPアドレス」とし、ひとまとまりの中のIPアドレスを「プライベートIPアドレス」としたのです。

プライベートIPアドレスは、そのひとまとまりの大きさ（コンピュータの数）に応じて、
クラスA
クラスB
クラスC
の3種類にわけられています。

プライベートIPアドレスは、たとえば、クラスCなら、先頭2バイトは、「192.168」にするように国際的に決められています。3番目の1ﾊﾞｲﾄは、そのグループで任意に決めることができます。4番めの1バイトは、個々のコンピュータに割り当てることになります。

プライベートIPアドレスは、インターネット空間に出ていくことはないので、他のグループとの重複を気にすることなく設定することができます。

個々のコンピュータにプライベートIPアドレスを設定するには、手作業で設定することが可能ですが、自動的に設定されるようにしておいたほうが便利です。これは、そのプライベートネットワーク（ローカルエリアネットワーク）に1台「DHCPサーバ」を設置して、個々のコンピュータが起動すればDHCPサーバがそのコンピュータに対して適当なIPアドレスを割り振るようにするのです。各家庭のネットワークはたいていこの設定になってます。コンピュータをネットワークに接続するのが簡単になるからです。

ただし、自由にコンピュータをネットワークに接続させたくない場合もあります。その場合は、そのネットワークの管理者が個々のコンピュータにIPアドレスを割り振ることになります。各ユーザが勝手にそのネットワークに接続することはできません。

このように、ローカルエリアネットワークに属している個々のコンピュータは、デフォルト・ゲートウェイを通ってインターネットに接続し、そのとき、グローバルIPアドレスというIPアドレスとして出ていくことになります。

/****************************************
IPアドレスと名前解決
****************************************/

さて、コンピュータ同士はIPアドレスによってお互いを知り合うのですが、これは人間にとってはわかりにくいものです。このIPアドレスを人間にわかりやすくしたものが「ドメイン」名、それと、「ホスト」名です。

たとえば、グーグルのトップページは、「https://www.google.co.jp」ですが、これをIPアドレスで表現すると、「216.58.196.227」です。人間は、ほかのコンピュータを知るには、この「ドメイン名（ホスト名）」のほうがわかりやすいですね。

先頭の「https://」は、あとに続く文字列が何を伝えようとしているのかを示しています。
「https」の他、「http」「ftp」「git」などがあります。

「www」は、ホスト名です。Webサーバーが動いているコンピュータには、wwwというホスト名がつけられることが多いです。
第4レベルドメインとも言われます。省略することが可能で、その場合は、「www」というホスト名だとみなされます。
「goole」は、グーグルがつけたドメイン名で、第3レベルドメインです。
「co」は、第2レベルドメインで、この場合「会社組織」を表現しています。
「jp」は、第1レベルドメインで、国を表しています。

ドメイン名は、さまざまな書き表し方が可能ですが、世界中で一意のものでなければなりません。

ですから、ドメイン名を管理認定している事業者がいます。日本にも22社あります。

人間は、コンピュータを操作しながら、このドメイン名で他のコンピュータと通信しようとします。

その人間が入力したドメイン名を、コンピュータが使っているIPアドレスに変換しなくてはなりません。これが「名前解決」と言われているもので、「DNSサーバー（ネームサーバー）」がその仕事をしています。

DNSサーバーは個人が設置することが可能です。各DNSサーバーは、自分の属する組織（ドメイン）からの問い合わせに対して、把握しているものであれば回答し、把握していないものであれば、上位のDNSサーバーに問い合わせます。上位のDNSサーバーも同様に処理をします。
DNSサーバーは、インターネットを支えている根幹の部分なので、DNSサーバーがトラブルによって故障すると大変です。したがって、どの組織も最低2台は運用しています。1台がストップしても、もう1台につねにバックアップされているから、それで運用できるわけです。
一番上位のDNSサーバーを「ルートサーバー」といい、全世界で13組設置されています。アメリカ・10、ロンドン・1、ストックホルム・1、東京・1、です。

ドメインネームからIPアドレスを問い合わせるには、Windowsのコマンドプロンプトでは、以下のようにします。

> nslookup www.google.co.jp <Enter>
Name:   www.google.co.jp
Address: 216.58.196.227

/****************************************
インターネット接続の実際
****************************************/

インターネットに接続するのは、コンピューターではなく、実際はネットワーク・デバイスであることは、先に述べました。ここでもう一つ、追加で述べなくてはなりません。
インターネットに接続するのは、コンピューターの中のプログラム（アプリ）なのです。インターネットに接続しようと、そのアプリが外部に通信しようとするとき、オペレーションシステムから「ポート」（出入り口）が割り振られます。
たとえば、ブラウザがグーグルのトップページにアクセスするとします。その場合は、以下のようになります。

ブラウザにポート番号（これは決まっていない）が割り振られ、ネットワークデバイスを通して、通信データが外部に出ていく。その際、そのデータには、ヘッダ情報として「出発点ポート番号」「出発点IPアドレス」「宛先ドメイン」が記載されます。

それで、外部のDNSサーバと通信し、「宛先IPアドレス」を知ります。外部のDNSサーバは、「出発点IPアドレス」と「出発点ポート番号」を手がかりにして「宛先IPアドレス」を出発点ブラウザに送り返してきます。

今度は、　ブラウザは、目的地のサイト（今回の場合はグーグル）に向かって、「ページを見せてくれ」という要求を送ります。その際、さっきと同様に、ヘッダ情報として、「出発点ポート番号」「出発点IPアドレス」「宛先IPアドレス」「宛先ポート番号」を記載します。

「宛先ポート番号」は、固定されています。「http」の場合は80番、「https」の場合は443番と、国際的に取り決められています。でないと、宛先ポート番号がわからなくなるので、通信できないのです。

さて、先程は、説明をとばしましたが、「出発点IPアドレス」は、実はプライペートIPアドレスです。この通信は、このローカルエリアネットワークと外部のネットワークとの中継点すなわり「ルータ」という機器を通って外部に出ていきます。

この「ルータ」を通過する際、「ルータ」は、ヘッダ情報にルータのもっている「グローバルIPアドレス」を付け加えます。それで外部に出ていきます。

通信データは、グーグルのサイトで動いている「Webサーバ・プロウラム」に届きます。これが80番ポートならびに443番オートを使っているのです。「ページを見せてくれ」という要求ですので、その「応答」をお繰り返します。ヘッダ情報に「出発点グローバルIPアドレス」が記載されているので、それを「宛先IPアドレス」としてヘッダ情報に付け加えます。また、グーグル自身のIPアドレスとポート番号もそれぞれ「出発点IPアドレス」「出発点ポート番号」として付け加えます。

このデータは、宛先グローバルIPアドレスをもっている「ルータ」に帰ってきます。ルータは、届いたデータのヘッダ情報を見て、その宛先の部分に、出発点の「プライベートIPアドレス」と「ポート番号」を知ります。そして、そのプライベートIPアドレスを持っているネットワークデバイスすなわりコンピュータにデータを送ります。そのコンピュータでは、届いたデータの「宛先ポード番号」にデータが届くので、ブラウザにデータが届き、そのデータをブラウザで表示するというわけです。

これが、インターネット通信の実際（の一部）です。

